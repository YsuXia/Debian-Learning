<map version="1.0.1">
<!-- To view this file, download free mind mapping software FreeMind from http://freemind.sourceforge.net -->
<node CREATED="1456222792268" ID="ID_1498538347" MODIFIED="1456279876010" TEXT="V4L2-Framework">
<font BOLD="true" ITALIC="true" NAME="SansSerif" SIZE="12"/>
<node CREATED="1456222858229" ID="ID_1988131115" MODIFIED="1469155383395" POSITION="right" TEXT="&#x8bbe;&#x5907;&#x5b9e;&#x4f8b;">
<font BOLD="true" NAME="SansSerif" SIZE="12"/>
<node CREATED="1456223078399" ID="ID_148465083" MODIFIED="1527605852214">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#25968;&#25454;&#32467;&#26500;:v4l2_device
    </p>
    <p>
      &#22810;&#25968;&#26102;&#20505;&#38598;&#25104;&#21040;&#19968;&#20010;&#26356;&#22823;&#30340;&#32467;&#26500;&#20307;&#24403;&#20013;
    </p>
  </body>
</html></richcontent>
<node CREATED="1456223398593" ID="ID_464864829" MODIFIED="1456223766416">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#65297;&#65294;&#38598;&#25104;&#23186;&#20307;&#26694;&#26550;
    </p>
    <p>
      &#12288;&#35774;&#32622;&#20869;&#37096;&#30340;mdev&#25104;&#21592;&#21464;&#37327;&#65292;&#37027;&#20040;&#35774;&#22791;&#21644;&#23376;&#35774;&#22791;&#23558;&#20250;&#20316;&#20026;&#23186;&#20307;&#23646;&#24615;&#20986;&#29616;&#22312;
    </p>
    <p>
      &#12288;&#23186;&#20307;&#26694;&#26550;&#24403;&#20013;&#20102;&#65294;
    </p>
    <p>
      &#38598;&#25104;&#23186;&#20307;&#26694;&#26550;&#26102;&#38656;&#35201;&#25163;&#21160;&#35774;&#32622;dev-&gt;drv_data&#29992;&#20110;&#25351;&#21521;&#21253;&#21547;v4l2_device&#30340;
    </p>
    <p>
      &#32467;&#26500;&#20307;&#65292;&#21516;&#26102;mdev&#38656;&#35201;&#25351;&#21521;&#21253;&#21547;media_device&#30340;&#32467;&#26500;&#20307;
    </p>
    <p>
      <i>dev_set_drvdata()</i>
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456223588707" ID="ID_690024319" MODIFIED="1456224665323">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2.&#27880;&#20876;&#35774;&#22791;&#23454;&#20363;
    </p>
    <p>
      v4l2_device_register(struct device *dev, struct v4l2_device *v4l2_dev)
    </p>
    <p>
      &#22914;&#26524;dev-&gt;drvdata&#37096;&#20998;&#20026;&#31354;&#65292;&#23558;&#20250;&#25351;&#21521;v4l2_dev
    </p>
    <p>
      &#22914;&#26524;dev&#20026;NULL&#65292;&#37027;&#20040;&#24517;&#39035;&#25163;&#21160;&#35774;&#32622;v4l2_dev-&gt;name&#22495;
    </p>
    <p>
      dev&#36890;&#24120;&#20026;&#25351;&#21521;pci_dev&#65292;usb_interface&#25110;&#32773;platform_device&#30340;&#25351;&#38024;
    </p>
    <p>
      dev&#20026;null&#30340;&#24773;&#20917;&#34429;&#28982;&#32597;&#35265;&#20294;&#20063;&#26159;&#26377;&#30340;&#65292;&#27604;&#22914;&#26377;&#22810;&#20010;pci&#35774;&#22791;&#30340;&#24773;&#20917;&#19979;&#23601;&#19981;&#33021;&#35753;
    </p>
    <p>
      v4l2_dev&#20851;&#32852;&#21040;&#26576;&#20010;&#20855;&#20307;&#30340;dev&#19978;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456224844554" ID="ID_804131683" MODIFIED="1456385503234">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3.&#27880;&#38144;&#35774;&#22791;&#23454;&#20363;
    </p>
    <p>
      v4l2_device_unregister(struct v4l2_device *v4l2_dev)
    </p>
    <p>
      &#27492;&#26102;dev-&gt;drv_data&#20250;&#34987;&#35774;&#32622;&#25104;NULL,&#25152;&#26377;&#30340;&#23376;&#35774;&#22791;&#20063;&#20250;&#34987;&#33258;&#21160;&#27880;&#38144;
    </p>
    <p>
      
    </p>
    <p>
      &#23545;&#20110;&#21487;&#28909;&#25554;&#25300;&#30340;&#35774;&#22791;&#30340;&#27880;&#38144;:
    </p>
    <p>
      v4l2_device_disconnect(struct v4l2_device *v4l2_dev)
    </p>
    <p>
      &#29992;&#20110;&#26631;&#35760;&#29238;&#35774;&#22791;&#24050;&#32463;&#34987;&#31227;&#38500;&#65292;&#28982;&#21518;&#21487;&#20197;&#35843;&#29992;
    </p>
    <p>
      v4l2_device_unregister()&#29992;&#20110;&#27880;&#38144;&#35774;&#22791;&#21644;&#23376;&#35774;&#22791;
    </p>
  </body>
</html></richcontent>
<linktarget COLOR="#e50e0e" DESTINATION="ID_804131683" ENDARROW="Default" ENDINCLINATION="569;0;" ID="Arrow_ID_1467501976" SOURCE="ID_350973843" STARTARROW="None" STARTINCLINATION="1394;-959;"/>
<node CREATED="1456282404387" ID="ID_557655372" MODIFIED="1456282996248">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#24341;&#29992;&#35745;&#25968;&#22120;&#21021;&#22987;&#21270;&#30340;&#20540;&#26159;&#65297;
    </p>
    <p>
      &#25152;&#20197;&#22312;usb&#35774;&#22791;&#30340;disconnect&#20989;&#25968;&#37324;&#38754;&#25110;&#32773;&#22312;pci&#35774;&#22791;&#30340;remove&#20989;&#25968;&#37324;&#38754;
    </p>
    <p>
      &#38656;&#35201;&#35843;&#29992;v4l2_device_put&#65292;&#21542;&#21017;&#24341;&#29992;&#35745;&#25968;&#27704;&#36828;&#19981;&#20250;&#21464;&#25104;0
    </p>
  </body>
</html></richcontent>
<arrowlink COLOR="#c10909" DESTINATION="ID_906361615" ENDARROW="Default" ENDINCLINATION="448;0;" ID="Arrow_ID_251006360" STARTARROW="None" STARTINCLINATION="77;-9;"/>
</node>
</node>
<node CREATED="1456280853502" ID="ID_280100042" MODIFIED="1527647272016">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      4.&#36845;&#20195;&#25152;&#26377;&#30340;&#30001;&#26576;&#20010;&#39537;&#21160;&#27880;&#20876;&#30340;&#25152;&#26377;&#30340;&#35774;&#22791;
    </p>
    <p>
      &#160;<i><b>148 static int callback(struct device *dev, void *p) </b></i>
    </p>
    <p>
      <i><b>&#160;149 { </b></i>
    </p>
    <p>
      <i><b>&#160;150&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;struct v4l2_device *v4l2_dev = dev_get_drvdata(dev); </b></i>
    </p>
    <p>
      <i><b>&#160;151 </b></i>
    </p>
    <p>
      <i><b>&#160;152&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* test if this device was inited */ </b></i>
    </p>
    <p>
      <i><b>&#160;153&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (v4l2_dev == NULL) </b></i>
    </p>
    <p>
      <i><b>&#160;154&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return 0; </b></i>
    </p>
    <p>
      <i><b>&#160;155&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;... </b></i>
    </p>
    <p>
      <i><b>&#160;156&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return 0; </b></i>
    </p>
    <p>
      <i><b>&#160;157 } </b></i>
    </p>
    <p>
      <i><b>&#160;158 </b></i>
    </p>
    <p>
      <i><b>&#160;159 int iterate(void *p) </b></i>
    </p>
    <p>
      <i><b>&#160;160 { </b></i>
    </p>
    <p>
      <i><b>&#160;161&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;struct device_driver *drv; </b></i>
    </p>
    <p>
      <i><b>&#160;162&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;int err; </b></i>
    </p>
    <p>
      <i><b>&#160;163 </b></i>
    </p>
    <p>
      <i><b>&#160;164&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* Find driver 'ivtv' on the PCI bus. </b></i>
    </p>
    <p>
      <i><b>&#160;165&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;pci_bus_type is a global. For USB busses use usb_bus_type. */ </b></i>
    </p>
    <p>
      <i><b>&#160;166&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;drv = driver_find(&quot;ivtv&quot;, &amp;pci_bus_type); </b></i>
    </p>
    <p>
      <i><b>&#160;167&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* iterate over all ivtv device instances */ </b></i>
    </p>
    <p>
      <i><b>&#160;168&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;err = driver_for_each_device(drv, NULL, p, callback);&#160;&#160; </b></i><b><font color="#eb1010">iterate all devices bound to this driver</font></b>
    </p>
    <p>
      <i><b>&#160;169&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;put_driver(drv); </b></i>
    </p>
    <p>
      <i><b>&#160;170&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return err; </b></i>
    </p>
    <p>
      <i><b>&#160;171 }</b></i>
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456281591157" ID="ID_906361615" MODIFIED="1456282996249">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      5.&#24341;&#29992;&#35745;&#25968;
    </p>
    <p>
      &#160;&#160;&#160;A.&#23545;&#20110;&#28909;&#25554;&#25300;&#35774;&#22791;&#65292;&#24403;&#25317;&#26377;&#22810;&#20010;&#35774;&#22791;&#33410;&#28857;&#30340;&#26102;&#20505;&#65292;&#24456;&#38590;&#30693;&#36947;&#24212;&#35813;&#20160;&#20040;&#26102;&#20505;
    </p>
    <p>
      &#12288;&#27880;&#38144;&#35774;&#22791;&#65294;v4l2_device&#20869;&#37096;&#26377;&#19968;&#20010;&#24341;&#29992;&#35745;&#25968;&#22120;
    </p>
    <p>
      &#24403;video_register_device&#35843;&#29992;&#30340;&#26102;&#20505;&#24341;&#29992;&#35745;&#25968;&#22120;&#22686;&#21152;
    </p>
    <p>
      &#24403;&#35774;&#22791;&#20960;&#28857;&#37322;&#25918;&#30340;&#26102;&#20505;&#24341;&#29992;&#35745;&#25968;&#22120;&#20540;&#20943;&#23569;&#65292;&#24403;&#24341;&#29992;&#35745;&#25968;&#22120;
    </p>
    <p>
      &#30340;&#20540;&#20943;&#23569;&#21040;&#65296;&#30340;&#26102;&#20505;release()&#20989;&#25968;&#23601;&#20250;&#34987;&#35843;&#29992;&#65292;&#21487;&#20197;&#22312;release&#20989;&#25968;&#37324;&#38754;&#20570;
    </p>
    <p>
      &#26368;&#21518;&#30340;&#28165;&#29702;&#24037;&#20316;&#65294;
    </p>
    <p>
      &#160;&#160;&#160;B.&#23545;&#20110;&#20687;alsa&#35774;&#22791;&#33410;&#28857;&#30340;&#24314;&#31435;&#65292;&#25105;&#20204;&#21487;&#20197;&#25163;&#21160;&#22320;&#22686;&#21152;&#21644;&#20943;&#23569;&#24341;&#29992;&#35745;&#25968;&#22120;&#30340;&#20540;
    </p>
    <p>
      &#12288;void v4l2_device_get(struct v4l2_device *v4l2_dev)
    </p>
    <p>
      &#12288;int v4l2_device_put(struct v4l2_device *v4l2_dev)
    </p>
  </body>
</html></richcontent>
<linktarget COLOR="#c10909" DESTINATION="ID_906361615" ENDARROW="Default" ENDINCLINATION="448;0;" ID="Arrow_ID_251006360" SOURCE="ID_557655372" STARTARROW="None" STARTINCLINATION="77;-9;"/>
</node>
</node>
</node>
<node CREATED="1456222860959" ID="ID_1547948907" MODIFIED="1527605829815" POSITION="left">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      v4l2&#30340;&#35774;&#22791;&#33410;&#28857;video_device
    </p>
  </body>
</html></richcontent>
<font BOLD="true" NAME="SansSerif" SIZE="12"/>
<node CREATED="1456380934173" ID="ID_22534589" MODIFIED="1469155379961">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#f21111"><i>&#20998;&#37197;&#35774;&#22791;&#33410;&#28857;</i></font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1456380966501" ID="ID_976246450" MODIFIED="1456381019787">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#21160;&#24577;&#20998;&#37197;:
    </p>
    <p>
      struct video_device *vdev = video_device_alloc();
    </p>
    <p>
      vdev-&gt;release = video_device_release;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456380970341" ID="ID_1208168620" MODIFIED="1456381094452">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#38745;&#24577;&#20998;&#37197;-&#23884;&#20837;&#21040;&#19968;&#20010;&#26356;&#22823;&#30340;&#32467;&#26500;&#20307;&#24403;&#20013;
    </p>
    <p>
      struct video_device *vdev = &amp;my_vdev-&gt;vdev;
    </p>
    <p>
      vdev-&gt;release = my_vdev_release;
    </p>
    <p>
      &#24517;&#39035;&#35774;&#32622;release&#20989;&#25968;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1456381653038" ID="ID_1243890461" MODIFIED="1469155376239">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#d90909"><i>&#35774;&#32622;&#22495;&#25104;&#21592;</i></font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1456381680046" ID="ID_475489739" MODIFIED="1456381720550">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      v4l2_dev&#25351;&#21521;v4l2_device&#36825;&#20010;&#29238;&#35774;&#22791;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456381725278" ID="ID_1655021447" MODIFIED="1456381845780">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#35774;&#32622;vfl_dir:
    </p>
    <p>
      VFL_DIR_RX&#20195;&#34920;capture&#35774;&#22791;
    </p>
    <p>
      VFL_DIR_TX&#20195;&#34920;output&#35774;&#22791;
    </p>
    <p>
      VFL_DIR_M2M&#20195;&#34920;mem2mem&#35774;&#22791;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456382102207" ID="ID_1256018037" MODIFIED="1456382122593">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#35774;&#32622;fops&#25351;&#21521;v4l2_file_operations&#32467;&#26500;&#20307;
    </p>
  </body>
</html></richcontent>
<node CREATED="1527663093444" ID="ID_549285698" MODIFIED="1527663544550">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#22914;&#26524;&#24819;&#20351;&#29992;v4l2_ioctl_ops&#21017;&#24517;&#39035;&#35774;&#32622;
    </p>
    <p>
      v4l2_file_operations&#37324;&#38754;&#30340;<b>.unlock_ioctl&#20026;video_ioctl2</b>
    </p>
    <p>
      &#19981;&#24314;&#35758;&#20351;&#29992;.ioctl, &#36825;&#20010;&#36873;&#39033;&#21518;&#38754;&#35201;&#34987;&#24223;&#24323;&#25481;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1527663711700" ID="ID_1424751391" MODIFIED="1527663795429">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      v4l2_file_operation&#26159;file_operations&#30340;&#23376;&#38598;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1527663870483" ID="ID_832242071" MODIFIED="1527663882509">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void v4l2_fh_init(struct v4l2_fh *fh, struct video_device *vdev)
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;Initialise the file handle. This *MUST* be performed in the driver's
    </p>
    <p>
      &#160;&#160;v4l2_file_operations-&gt;open() handler.
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1456382926968" ID="ID_1581922574" MODIFIED="1456383183880">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#35774;&#32622;ioctl_ops:
    </p>
    <p>
      &#20351;&#29992; v4l2_ioctl_ops&#26469;&#31616;&#21270;ioctl&#30340;&#31649;&#29702;
    </p>
    <p>
      &#36890;&#36807;vfl_type&#21644;vfl_dir&#30340;&#32452;&#21512;&#21487;&#20197;&#31105;&#29992;&#37027;&#20123;&#19981;&#31526;&#21512;type/dir
    </p>
    <p>
      &#32452;&#21512;&#30340;ops&#25805;&#20316;&#65294;&#36825;&#31181;&#26041;&#24335;&#20351;&#24471;&#25351;&#21521;video&#21644;vbi&#33410;&#28857;
    </p>
    <p>
      &#25552;&#20379;&#19968;&#31181;v4l2_ioctl_ops&#25104;&#20026;&#20102;&#21487;&#33021;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456383221047" ID="ID_666458243" MODIFIED="1456383270603">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#35774;&#32622;lock&#22495;&#65292;&#22914;&#26524;&#35813;&#22495;&#34987;&#35774;&#32622;&#65292;
    </p>
    <p>
      &#37027;&#20040;&#26680;&#24515;&#22312;&#35843;&#29992;unlocked_ioctl&#20043;&#21069;&#20250;&#20351;&#29992;&#35813;lock
    </p>
    <p>
      &#36827;&#34892;&#19978;&#38145;&#30340;&#21160;&#20316;&#65294;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456383430617" ID="ID_236959946" MODIFIED="1456383479444">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#35774;&#32622;queue&#65292;&#35813;&#25351;&#38024;&#25351;&#21521;vb2_queue&#32467;&#26500;&#20307;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456383734433" ID="ID_977697938" MODIFIED="1456383771679">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#35774;&#32622; dev_parent
    </p>
    <p>
      &#24403;v4l2_device&#27809;&#26377;&#35774;&#32622;&#33258;&#24049;&#30340;&#29238;&#35774;&#22791;&#30340;&#26102;&#20505;
    </p>
    <p>
      dev_parent&#38656;&#35201;&#34987;&#21333;&#29420;&#35774;&#32622;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456384538593" ID="ID_857807398" MODIFIED="1456384675486">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#34701;&#21512;&#36827;&#20837;&#23186;&#20307;&#26694;&#26550;&#24403;&#20013;:
    </p>
    <p>
      &#21021;&#22987;&#21270;video_device&#32467;&#26500;&#20307;&#24403;&#20013;&#30340;media_entity struct
    </p>
    <p>
      struct media_pad *pad = &amp;my_vdev-&gt;pad
    </p>
    <p>
      err = media_entity_init(&amp;vdev-&gt;entity, 1, pad, 0)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456385337796" ID="ID_350973843" MODIFIED="1456385508257">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#24403;&#21487;&#25554;&#25300;&#35774;&#22791;&#34987;&#31227;&#38500;&#30340;&#26102;&#20505;&#65292;&#38656;&#35201;&#21152;&#38145;
    </p>
    <p>
      &#39318;&#20808;&#38656;&#35201;&#38145;&#23450;video_device-&gt;queue-&gt;lock
    </p>
    <p>
      &#28982;&#21518;&#38656;&#35201;&#38145;&#23450;video_device-&gt;lock
    </p>
    <p>
      &#36825;&#26679;&#22312;&#35843;&#29992;v4l2_device_disconnec&#30340;&#26102;&#20505;&#23601;&#21487;&#20197;&#30830;&#23450;
    </p>
    <p>
      &#27809;&#26377;Ioctl&#20989;&#25968;&#22312;&#36816;&#34892;&#20102;&#65294;
    </p>
  </body>
</html></richcontent>
<arrowlink COLOR="#e50e0e" DESTINATION="ID_804131683" ENDARROW="Default" ENDINCLINATION="569;0;" ID="Arrow_ID_1467501976" STARTARROW="None" STARTINCLINATION="1394;-959;"/>
</node>
</node>
<node CREATED="1456385908794" ID="ID_224549283" MODIFIED="1456385908794" TEXT="">
<node CREATED="1456385911572" ID="ID_1930671411" MODIFIED="1469155374921">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#da0808"><i>&#27880;&#20876;&#35774;&#22791;&#33410;&#28857;</i></font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1456385925379" ID="ID_767979362" MODIFIED="1456388894348">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b><i>video_register_device(vdev, VFL_TYPE_GRABBER, -1)</i></b>
    </p>
    <p>
      &#22914;&#26524;video_device&#30340;&#29238;&#35774;&#22791;v4l2_device&#30340;mdev&#22495;&#19981;&#20026;&#31354;&#65292;
    </p>
    <p>
      &#37027;&#20040;video_device&#20250;&#34987;&#33258;&#21160;&#22320;&#38598;&#25104;&#21040;&#23186;&#20307;&#35774;&#22791;&#24403;&#20013;&#21435;&#65294;
    </p>
    <p>
      VFL_TYPE_GRABBER&#20195;&#34920;&#36755;&#20837;&#36755;&#20986;&#35774;&#22791;
    </p>
    <p>
      VFL_TYPE_VBI&#20195;&#34920;&#22402;&#30452;&#31354;&#30333;&#25968;&#25454;
    </p>
    <p>
      VFL_TYPE_RADIO&#20195;&#34920;radio tuner
    </p>
    <p>
      VFL_TYPE_SDR&#20195;&#34920;&#36719;&#20214;&#23450;&#20041;&#30340;radio tuner
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1456389194222" ID="ID_913236968" MODIFIED="1456389219448">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <u><font color="#e40606"><i>&#24110;&#21161;&#20989;&#25968;</i></font></u>
    </p>
  </body>
</html></richcontent>
<node CREATED="1456389257094" ID="ID_371072251" MODIFIED="1456389400161">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      void *video_get_drvdata(struct video_device *vdev);
    </p>
    <p>
      void video_set_drvdata(struct video_device *vdev, void *data);
    </p>
    <p>
      
    </p>
    <p>
      struct video_device *video_devdata(struct file *file)
    </p>
    <p>
      
    </p>
    <p>
      const char *video_device_node_name(struct video_device *vdev)
    </p>
    <p>
      
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456389403582" ID="ID_1961512414" MODIFIED="1456389891614">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#e00707">video_buffer&#24110;&#21161;&#20989;&#25968; </font>
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1456222863406" ID="ID_1740167756" MODIFIED="1456283030532" POSITION="right" TEXT="&#x5b50;&#x8bbe;&#x5907;&#x5b9e;&#x4f8b;">
<font BOLD="true" NAME="SansSerif" SIZE="12"/>
<node CREATED="1456223113677" ID="ID_985161457" MODIFIED="1527605849735" TEXT="&#x6570;&#x636e;&#x7ed3;&#x6784;v4l2_subdev">
<node CREATED="1456224724087" ID="ID_456067746" MODIFIED="1456224807137">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1.&#29238;&#35774;&#22791;&#21487;&#20197;&#25552;&#20379;notify()&#22238;&#35843;&#20989;&#25968;&#65292;&#35813;&#20989;&#25968;&#29992;&#20110;&#23376;&#35774;&#22791;&#36890;&#30693;&#29238;&#35774;&#22791;event
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456283536116" ID="ID_1162822204" MODIFIED="1456377084759">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2.&#36890;&#36807; v4l2_set_subdevdata()&#20989;&#25968;&#21487;&#20197;&#23558;&#24213;&#23618;&#30340;&#35774;&#22791;&#25968;&#25454;&#65292;&#27604;&#22914;
    </p>
    <p>
      &#160;A.i2c_client&#35774;&#32622;&#21040;private&#22495;&#37324;&#38754;&#65294;&#36825;&#26679;&#23601;&#25552;&#20379;&#20102;&#19968;&#31181;&#20174;&#23376;&#35774;&#22791;&#21040;&#24213;&#23618;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#24635;&#32447;&#20855;&#20307;&#35774;&#22791;&#30340;&#26041;&#27861;&#65294;
    </p>
    <p>
      &#160;B.&#21516;&#26102;&#22312;&#24213;&#23618;&#35774;&#22791;&#37324;&#38754;&#27604;&#22914;i2c_client&#65292;&#36890;&#36807;i2c_set_clientdata()&#21487;&#20197;&#23558;
    </p>
    <p>
      &#160;C.&#19978;&#23618;&#30340;subdev&#35774;&#22791;&#35774;&#32622;&#21040;&#24213;&#23618;&#30340;&#35774;&#22791;&#25968;&#25454;&#24403;&#20013;&#65292;&#20854;&#20182;&#24635;&#32447;&#30340;&#20351;&#29992;&#26041;&#27861;&#31867;&#20284;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#26725;&#39537;&#21160;&#24403;&#20013;&#20063;&#35201;&#20445;&#23384;&#27599;&#20010;&#35774;&#22791;&#30340;&#31169;&#26377;&#25968;&#25454;&#65292;&#27604;&#22914;&#27599;&#20010;&#35774;&#22791;&#24403;&#20013;&#30340;&#25351;&#21521;&#29305;&#23450;&#30340;&#26725;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#30340;&#31169;&#26377;&#25968;&#25454;&#25351;&#38024;
    </p>
  </body>
</html></richcontent>
<arrowlink COLOR="#341e88" DESTINATION="ID_1402498115" ENDARROW="Default" ENDINCLINATION="222;0;" ID="Arrow_ID_341926369" STARTARROW="None" STARTINCLINATION="298;-52;"/>
<linktarget COLOR="#e00c16" DESTINATION="ID_1162822204" ENDARROW="Default" ENDINCLINATION="187;0;" ID="Arrow_ID_1179403424" SOURCE="ID_1447224356" STARTARROW="None" STARTINCLINATION="187;0;"/>
</node>
<node CREATED="1456294265209" ID="ID_740003753" MODIFIED="1456294279917">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b>&#25968;&#25454;&#25104;&#21592;</b>
    </p>
  </body>
</html></richcontent>
<node CREATED="1456294283056" ID="ID_1447224356" MODIFIED="1456294397109">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#20027;&#26426;&#31169;&#26377;&#22495;host_priv:
    </p>
    <p>
      &#29992;&#20110;&#35774;&#32622;&#36319;&#26725;&#35774;&#22791;&#26377;&#20851;&#30340;&#31169;&#26377;&#25968;&#25454;
    </p>
    <p>
      v4l2_set_subdev_hostdata()
    </p>
    <p>
      v4l2_get_subdev_hostdata()
    </p>
  </body>
</html></richcontent>
<arrowlink COLOR="#e00c16" DESTINATION="ID_1162822204" ENDARROW="Default" ENDINCLINATION="187;0;" ID="Arrow_ID_1179403424" STARTARROW="None" STARTINCLINATION="187;0;"/>
</node>
</node>
<node CREATED="1456294746592" ID="ID_178158888" MODIFIED="1456298948511">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b>&#20989;&#25968;&#25351;&#38024;&#32467;&#26500;&#20307;: </b>
    </p>
    <p>
      subdevice&#30340;&#39537;&#21160;&#31243;&#24207;&#36890;&#36807;&#35843;&#29992;sub_dev&#37324;&#38754;&#30340;&#20989;&#25968;&#26469;&#23454;&#29616;&#19981;&#21516;&#30340;&#21151;&#33021;&#65294;
    </p>
    <p>
      sub_dev&#37324;&#38754;&#30340;&#20989;&#25968;&#32467;&#26500;&#20307;&#34987;&#25353;&#29031;&#21151;&#33021;&#20998;&#38376;&#21035;&#31867;&#65292;&#39030;&#23618;&#30340;&#20989;&#25968;&#25351;&#38024;&#32467;&#26500;&#20307;
    </p>
    <p>
      &#21253;&#21547;&#20102;&#21487;&#20197;&#25351;&#21521;&#20854;&#20182;&#30340;&#20989;&#25968;&#25351;&#38024;&#32467;&#26500;&#20307;&#30340;&#20989;&#25968;&#65294;
    </p>
    <p>
      <i><b>&#39030;&#23618;&#30340;&#32467;&#26500;&#20307;&#22914;&#19979;&#25152;&#31034;: </b></i>
    </p>
    <p>
      <i><font color="#da1111"><b>520 struct v4l2_subdev_ops { </b></font></i>
    </p>
    <p>
      <i><font color="#da1111"><b>521&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;const struct v4l2_subdev_core_ops&#160;&#160;&#160;&#160;&#160;&#160;&#160;*core; </b></font></i>
    </p>
    <p>
      <i><font color="#da1111"><b>522&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;const struct v4l2_subdev_tuner_ops&#160;&#160;&#160;&#160;&#160;&#160;*tuner; </b></font></i>
    </p>
    <p>
      <i><font color="#da1111"><b>523&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;const struct v4l2_subdev_audio_ops&#160;&#160;&#160;&#160;&#160;&#160;*audio; </b></font></i>
    </p>
    <p>
      <i><font color="#da1111"><b>524&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;const struct v4l2_subdev_video_ops&#160;&#160;&#160;&#160;&#160;&#160;*video; </b></font></i>
    </p>
    <p>
      <i><font color="#da1111"><b>525&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;const struct v4l2_subdev_vbi_ops&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*vbi; </b></font></i>
    </p>
    <p>
      <i><font color="#da1111"><b>526&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;const struct v4l2_subdev_ir_ops&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*ir; </b></font></i>
    </p>
    <p>
      <i><font color="#da1111"><b>527&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;const struct v4l2_subdev_sensor_ops&#160;&#160;&#160;&#160;&#160;*sensor; </b></font></i>
    </p>
    <p>
      <i><font color="#da1111"><b>528&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;const struct v4l2_subdev_pad_ops&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*pad; </b></font></i>
    </p>
    <p>
      <i><font color="#da1111"><b>529 };</b></font></i>
    </p>
    <p>
      core&#26680;&#24515;&#20989;&#25968;&#38598;&#36866;&#29992;&#20110;&#25152;&#26377;&#30340;&#35774;&#22791;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1527745417748" ID="ID_1373655283" MODIFIED="1527745592868">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      internal_ops&#25351;&#38024;&#25351;&#21521;struct v4l2_subdev_internal_ops&#65292;&#36825;&#20010;&#32467;&#26500;&#20307;&#26159;&#32473;
    </p>
    <p>
      v4l2 &#26694;&#26550;&#26469;&#20351;&#29992;&#30340;&#65292;&#20854;&#20182;&#30340;&#39537;&#21160;&#31243;&#24207;&#19981;&#33021;&#20351;&#29992;&#12290;&#35813;&#32467;&#26500;&#20307;&#37324;&#38754;&#23450;&#20041;&#20102;&#22235;&#20010;&#20989;&#25968;
    </p>
    <p>
      registered&#65306; &#24403;&#23376;&#35774;&#22791;&#27880;&#20876;&#30340;&#26102;&#20505;&#20250;&#35843;&#29992;&#35813;&#20989;&#25968;&#65292;&#36825;&#26679;&#23376;&#35774;&#22791;&#21487;&#20197;&#25351;&#21521;v4l2_device&#35774;&#22791;&#20102;
    </p>
    <p>
      unregistered&#65306; &#23376;&#35774;&#22791;&#27880;&#38144;&#30340;&#26102;&#20505;&#20250;&#35843;&#29992;&#35813;&#20989;&#25968;
    </p>
    <p>
      open: &#24403;&#23376;&#35774;&#22791;&#30340;&#33410;&#28857;&#34987;&#24212;&#29992;&#31243;&#24207;&#25171;&#24320;&#30340;&#26102;&#20505;&#20250;&#35843;&#29992;&#35813;&#20989;&#25968;
    </p>
    <p>
      close:&#24403;&#23376;&#35774;&#22791;&#20851;&#38381;&#30340;&#26102;&#20505;&#20250;&#35843;&#29992;&#35813;&#20989;&#25968;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456299046549" ID="ID_287870645" MODIFIED="1527675437244">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b>&#20351;&#29992;&#27969;&#31243;</b>
    </p>
  </body>
</html></richcontent>
<node CREATED="1456299066075" ID="ID_769667320" MODIFIED="1456305742278">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1.&#21021;&#22987;&#21270;&#30340;&#27969;&#31243;
    </p>
    <p>
      &#39318;&#20808;v4l2_subdev_init(sd, &amp;ops)
    </p>
    <p>
      &#28982;&#21518;&#20351;&#29992;&#19968;&#20010;&#21807;&#19968;&#30340;&#21517;&#23383;&#21021;&#22987;&#21270;subdev-&gt;name
    </p>
    <p>
      &#21021;&#22987;&#21270;&#27169;&#22359;&#30340;owner &#22495;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456305748196" ID="ID_489623840" MODIFIED="1527689378078">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2.&#36319;&#23186;&#20307;&#26694;&#26550;&#36827;&#34892;&#25972;&#21512;
    </p>
    <p>
      &#160;&#160;&#38656;&#35201;&#21021;&#22987;&#21270;v4l2_subdev&#32467;&#26500;&#20307;&#37324;&#38754;&#30340;media_entity&#32467;&#26500;&#20307;
    </p>
    <p>
      &#160;&#160;struct media_pad *pads = &amp;my_sd-&gt;pads
    </p>
    <p>
      &#160;&#160;err = media_entity_init(&amp;sd-&gt;entity, npads, pads, 0) pads&#25968;&#32452;&#24517;&#39035;&#26159;&#20808;&#21069;&#23601;&#21021;&#22987;&#21270;&#22909;&#30340;
    </p>
    <p>
      <i>&#24403;<font color="#e41212">&#23376;&#35774;&#22791;&#33410;&#28857;&#34987;&#25171;&#24320;&#25110;&#32773;&#20851;&#38381;&#65292;&#23545;entity&#30340;&#24341;&#29992;&#23558;&#34987;&#33258;&#21160;&#33719;&#21462;&#25110;&#32773;&#37322;&#25918; </font></i>
    </p>
    <p>
      <i><font color="#e41212">&#23376;&#35774;&#22791;&#27880;&#38144;&#20043;&#21518;&#65292;&#38656;&#35201;&#36827;&#34892;&#28165;&#29702;&#24037;&#20316; </font></i>
    </p>
    <p>
      <i><font color="#e41212">&#160;media_entity_cleanup(&amp;sd-&gt;entity) </font></i>
    </p>
    <p>
      
    </p>
    <p>
      &#22914;&#26524;subdev&#30340;&#39537;&#21160;&#31243;&#24207;&#24819;&#35201;&#22788;&#29702;video,&#24182;&#19988;&#36824;&#24819;&#34701;&#21512;&#21040;media&#26694;&#26550;&#24403;&#20013;&#21435;&#65292;&#37027;&#20040;&#23427;&#24517;&#39035;&#20351;&#29992;
    </p>
    <p>
      v4l2_subdev_pad_ops&#25805;&#20316;&#38598;&#21512;&#22788;&#29702;&#36319;format&#26377;&#20851;&#30340;&#19996;&#35199;&#32780;&#19981;&#26159;&#20351;&#29992;v4l2_subdev_video_ops.
    </p>
  </body>
</html></richcontent>
<node CREATED="1456306817262" ID="ID_1241519880" MODIFIED="1456367100692">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#24403;&#23376;&#35774;&#22791;&#25972;&#21512;&#36827;&#20837;&#20102;&#23186;&#20307;&#26694;&#26550;&#20043;&#21518;&#65292;&#39537;&#21160;&#24212;&#35813;&#35774;&#32622;link_validate&#22495;&#65292;
    </p>
    <p>
      &#29992;&#20197;&#25552;&#20379;&#33258;&#36523;&#30340;&#38142;&#25509;&#39564;&#35777;&#20989;&#25968;&#65294;&#38142;&#25509;&#39564;&#35777;&#20989;&#25968;&#20250;&#34987;pipeline&#20013;&#30340;
    </p>
    <p>
      &#25152;&#26377;&#30340;links&#35843;&#29992;&#65292;&#36825;&#20123;links&#30340;&#20004;&#31471;&#37117;&#26159;v4l2&#35774;&#22791;&#65294;
    </p>
  </body>
</html></richcontent>
<linktarget COLOR="#d70c0c" DESTINATION="ID_1241519880" ENDARROW="Default" ENDINCLINATION="323;0;" ID="Arrow_ID_305171651" SOURCE="ID_583164122" STARTARROW="None" STARTINCLINATION="323;0;"/>
</node>
</node>
<node CREATED="1456307806165" ID="ID_1966994070" MODIFIED="1456377833354">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3.&#27880;&#20876;subdev&#21040;v4l2&#26680;&#24515;
    </p>
  </body>
</html></richcontent>
<node CREATED="1456307838600" ID="ID_1498982545" MODIFIED="1456308040016">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1.&#30001;&#26725;&#39537;&#21160;&#26469;&#36127;&#36131;&#27880;&#20876;&#23376;&#35774;&#22791;&#21040;v4l2&#26680;&#24515;&#65292;&#20856;&#22411;&#30340;&#26159;&#23545;&#20110;&#37027;&#20123;&#20869;&#37096;&#30340;&#35774;&#22791;
    </p>
    <p>
      &#12288;&#27604;&#22914;usb camera&#24403;&#20013;&#30340;camera sensor&#25110;&#32773;&#26159;&#30452;&#25509;&#36830;&#25509;&#21040;soc&#24403;&#20013;&#30340;
    </p>
    <p>
      &#12288;camera sensor.&#36825;&#20123;&#20869;&#37096;&#35774;&#22791;&#24448;&#24448;&#23558;&#33258;&#24049;&#30340;&#20449;&#24687;&#25918;&#20837;&#20102;platform data
    </p>
    <p>
      &#160;&#160;&#160;&#24403;&#20013;&#20102;&#65294;
    </p>
  </body>
</html></richcontent>
<node CREATED="1456377850289" ID="ID_1210579803" MODIFIED="1456378023316">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b>&#29305;&#21035;&#27880;&#24847;&#20107;&#39033;:</b>
    </p>
    <p>
      &#24403;&#26725;&#39537;&#21160;&#25703;&#27585;i2c&#36866;&#37197;&#22120;&#30340;&#26102;&#20505;&#65292;&#20301;&#20110;&#35813;&#36866;&#37197;&#22120;&#19978;&#38754;&#30340;I2c&#35774;&#22791;
    </p>
    <p>
      &#37324;&#38754;&#30340;remove&#20989;&#25968;&#20250;&#34987;&#35843;&#29992;&#65292;&#22312;remove&#20989;&#25968;&#24403;&#20013;&#35843;&#29992;
    </p>
    <p>
      v4l2_device_unregister_subdev(sd)&#20989;&#25968;&#30830;&#20445;v4l2_subdev
    </p>
    <p>
      &#20989;&#25968;&#34987;&#38144;&#27585;&#65294;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1456307840821" ID="ID_583164122" MODIFIED="1456368891324">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2.&#23376;&#35774;&#22791;&#24322;&#27493;&#22320;&#27880;&#20876;&#21040;&#26725;&#35774;&#22791;&#24403;&#20013;&#21435;&#65294;
    </p>
    <p>
      &#12288;&#21521;&#22522;&#20110;&#35774;&#22791;&#26641;&#30340;&#31995;&#32479;&#20856;&#22411;&#22320;&#23601;&#26159;&#36825;&#31181;&#37197;&#32622;&#65292;&#23376;&#35774;&#22791;&#30340;&#20449;&#24687;&#37117;&#26159;
    </p>
    <p>
      &#12288;&#29420;&#31435;&#22320;&#36890;&#36807;&#26725;&#35774;&#22791;&#26469;&#33719;&#21462;&#21040;&#30340;&#65294;
    </p>
    <p>
      &#12288;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#26725;&#35774;&#22791;&#39537;&#21160;&#24517;&#39035;&#20027;&#21160;&#27880;&#20876;&#23376;&#35774;&#22791;
    </p>
    <p>
      &#12288;int err = v4l2_device_register_subdev(v4l2_dev, sd)
    </p>
    <p>
      &#12288;&#36825;&#26679;&#23376;&#35774;&#22791;&#23601;&#21487;&#20197;&#25351;&#21521;v4l2_device&#20102;
    </p>
    <p>
      &#12288;<i>&#27880;&#38144;&#23376;&#35774;&#22791;v4l2_device_unregister_subdev(sd)</i>
    </p>
  </body>
</html></richcontent>
<arrowlink COLOR="#d70c0c" DESTINATION="ID_1241519880" ENDARROW="Default" ENDINCLINATION="323;0;" ID="Arrow_ID_305171651" STARTARROW="None" STARTINCLINATION="323;0;"/>
<node CREATED="1456367335601" ID="ID_168849381" MODIFIED="1456367527259">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#22312;&#24322;&#27493;&#27880;&#20876;&#30340;&#27169;&#24335;&#19979;&#38754;&#65292;subdevice&#39537;&#21160;&#31243;&#24207;&#36824;&#38656;&#35201;&#33258;&#20027;&#26816;&#27979;probe&#30340;&#26465;&#20214;&#26159;&#21542;
    </p>
    <p>
      &#37117;&#28385;&#36275;&#65292;&#22914;&#26524;&#37117;&#28385;&#36275;&#30340;&#24773;&#20917;&#19979;&#65292;&#23601;&#20250;&#35843;&#29992;
    </p>
    <p>
      v4l2_async_register_subdev()&#20989;&#25968;
    </p>
    <p>
      &#36890;&#36807;&#36825;&#31181;&#26041;&#24335;&#27880;&#20876;&#30340;&#23376;&#35774;&#22791;&#34987;&#25918;&#32622;&#21040;&#20102;&#19968;&#20010;&#20840;&#23616;&#30340;&#34920;&#37324;&#38754;&#65292;&#26041;&#20415;&#26725;&#39537;&#21160;&#36827;&#34892;&#26597;&#25214;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456368893570" ID="ID_1861610192" MODIFIED="1456369565027">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#26725;&#39537;&#21160;&#21453;&#36807;&#26469;&#38656;&#35201;&#27880;&#20876;&#19968;&#20010;&#24102;&#26377;&#23376;&#35774;&#22791;&#25551;&#36848;&#31526;&#30340;&#36890;&#30693;&#23545;&#35937;&#65292;&#29992;&#20110;&#25552;&#20379;
    </p>
    <p>
      &#32473;&#26725;&#35774;&#22791;&#36827;&#34892;&#30456;&#20851;&#30340;&#25805;&#20316;&#65294;
    </p>
    <p>
      &#36890;&#36807;v4l2_async_notifier_register()&#20989;&#25968;&#27880;&#20876;&#35813;&#23545;&#35937;
    </p>
    <p>
      &#35813;&#20989;&#25968;&#24102;&#26377;&#65298;&#20010;&#21442;&#25968;:
    </p>
    <p>
      1.&#19968;&#20010;&#25351;&#21521;v4l2_device&#32467;&#26500;&#20307;&#30340;&#25351;&#38024;
    </p>
    <p>
      2.&#19968;&#20010;&#25351;&#21521;v4l2_async_notifier&#32467;&#26500;&#20307;&#30340;&#25351;&#38024;&#65292;&#35813;&#32467;&#26500;&#20307;&#21253;&#21547;&#25351;&#21521;&#23376;&#35774;&#22791;
    </p>
    <p>
      &#12288;&#25551;&#36848;&#31526;&#25968;&#32452;&#30340;&#25351;&#38024;&#65294;
    </p>
    <p>
      &#12288;<b><i>v4l2&#26680;&#24515;&#20250;&#20351;&#29992;&#23427;&#20204;&#26469;&#21305;&#37197;&#24322;&#27493;&#27880;&#20876;&#21040;&#31995;&#32479;&#24403;&#20013;&#30340;&#23376;&#35774;&#22791;&#65292;&#19968;&#26086;&#21305;&#37197;&#25104;&#21151; </i></b>
    </p>
    <p>
      <b><i>&#12288;&#35813;&#32467;&#26500;&#20307;&#24403;&#20013;&#30340;bound&#22238;&#35843;&#20989;&#25968;&#23601;&#20250;&#34987;&#35843;&#29992;&#21040;</i></b>&#65294;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1456366662718" ID="ID_1913053199" MODIFIED="1456367077235">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3.&#21457;&#36865;&#36890;&#30693;&#21040;&#29238;&#35774;&#22791;
    </p>
    <p>
      &#12288;&#22914;&#26524;subdev&#38656;&#35201;&#21457;&#36865;&#36890;&#30693;&#21040;v4l2_device&#29238;&#35774;&#22791;&#65292;&#21017;&#21487;&#20197;&#21033;&#29992;&#23439;&#23450;&#20041;
    </p>
    <p>
      &#12288; v4l2_subdev_notify(sd, notification, arg)
    </p>
    <p>
      &#12288;&#35813;&#20989;&#25968;&#35843;&#29992;&#29238;&#35774;&#22791;&#24403;&#20013;&#27880;&#20876;&#32473;&#23376;&#35774;&#22791;&#20351;&#29992;&#30340;&#36890;&#30693;&#20989;&#25968;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1456371552190" ID="ID_1615980265" MODIFIED="1469155397557">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      4.v4l2_subdev&#29992;&#25143;&#31354;&#38388;API
    </p>
    <p>
      &#160;&#38500;&#20102;&#36890;&#36807;v4l2_subdev_ops&#26469;&#26292;&#38706;&#20869;&#26680;&#30340;API,v4l2_subdev&#36824;
    </p>
    <p>
      &#21487;&#20197;&#20174;&#29992;&#25143;&#31354;&#38388;&#34987;&#25511;&#21046;&#65294;
    </p>
    <p>
      &#12288;&#21487;&#20197;&#36890;&#36807;&#35775;&#38382;/dev/v4l-subdevX&#33410;&#28857;&#26469;&#25805;&#32437;&#23376;&#35774;&#22791;
    </p>
  </body>
</html></richcontent>
<node CREATED="1456371842626" ID="ID_1785839015" MODIFIED="1527745276993">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1.&#21019;&#24314;&#35774;&#22791;&#33410;&#28857;
    </p>
    <p>
      &#22914;&#26524;&#23376;&#35774;&#22791;&#24819;&#35201;&#33021;&#22815;&#20174;&#29992;&#25143;&#31354;&#38388;&#36827;&#34892;&#37197;&#32622;&#65292;&#37027;&#20040;&#22312;&#27880;&#20876;&#23376;&#35774;&#22791;&#20043;&#21069;&#65292;&#24517;&#39035;&#35201;&#35774;&#32622;V4L2_SUBDEV_FL_HAS_DEVNODE
    </p>
    <p>
      &#36825;&#20010;&#26631;&#24535;&#12290;
    </p>
    <p>
      &#12288;v4l2_device&#39537;&#21160;&#31243;&#24207;&#21487;&#20197;&#36890;&#36807;&#35843;&#29992;&#20989;&#25968;
    </p>
    <p>
      v4l2_device_register_subdev_nodes()&#26469;&#20026;&#24050;&#32463;&#27880;&#20876;&#36807;&#30340;&#23376;&#35774;&#22791;
    </p>
    <p>
      &#21019;&#24314;&#35774;&#22791;&#33410;&#28857;&#65294;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456372730610" ID="ID_1880270606" MODIFIED="1527750603329">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2.&#35774;&#22791;&#25805;&#20316;&#21629;&#20196;
    </p>
    <p>
      VIDIOC_QUERYCTRL
    </p>
    <p>
      VIDIOC_QUERYMENU
    </p>
    <p>
      VIDIOC_G_CTRL
    </p>
    <p>
      VIDIOC_S_CTRL
    </p>
    <p>
      VIDIOC_G_EXT_CTRLS
    </p>
    <p>
      VIDIOC_S_EXT_CTRLS
    </p>
    <p>
      VIDIOC_TRY_EXT_CTRLS
    </p>
    <p>
      &#36825;&#20123;control ioctl&#36319;v4l2_device&#37324;&#38754;&#30340;&#25511;&#21046;&#24456;&#20687;&#65292;&#20294;&#26159;&#38024;&#23545;&#30340;&#26159;v4l2_subdev&#30340;
    </p>
    <p>
      VIDIOC_DQEVENT
    </p>
    <p>
      VIDIOC_SUBSCRIBE_EVENT
    </p>
    <p>
      VIDIOC_UNSUBSCRIBE_EVENT
    </p>
    <p>
      &#36825;&#20123;&#25805;&#20316;&#38024;&#23545;&#30340;&#26159;event ioctl,&#23376;&#35774;&#22791;&#39537;&#21160;&#24819;&#35201;&#20351;&#29992;&#20107;&#20214;&#26426;&#21046;&#65292;&#24517;&#39035;&#22312;v4l2_subdev::flags
    </p>
    <p>
      &#20013;&#35774;&#32622;<b>V4L2_SUBDEV_USES_EVENTS&#26631;&#24535;</b>
    </p>
    <p>
      &#35774;&#32622;<b>v4l2_subdev::nevents</b>&#160;&#21040;&#30456;&#24212;&#30340;&#20107;&#20214;&#28145;&#24230;, &#27880;&#20876;&#20043;&#21518;&#26469;&#20020;&#30340;&#20107;&#20214;&#20250;&#34987;&#25918;&#32622;&#21040;v4l2_subdev::devnode
    </p>
    <p>
      &#23545;&#24212;&#30340;&#33410;&#28857;&#37324;&#38754;&#12290;&#20026;&#20102;&#25903;&#25345;&#20107;&#20214;&#26426;&#21046;&#65292;poll&#25991;&#20214;&#31995;&#32479;&#35843;&#29992;&#20250;&#34987;&#23454;&#29616;&#12290;
    </p>
    <p>
      Private ioctls&#12288;&#19978;&#38754;&#27809;&#26377;&#25552;&#21040;&#30340;ioctl&#20250;&#34987;&#30452;&#25509;&#36865;&#21040;subdev&#30340;core::ioctl&#37324;&#38754;&#36827;&#34892;&#22788;&#29702;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1456375871159" ID="ID_36497154" MODIFIED="1456376654667">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      5.I2C&#23376;&#35774;&#22791;&#39537;&#21160;
    </p>
    <p>
      &#22914;&#20309;&#20026;I2C&#35774;&#22791;&#28155;&#21152;v4l2_subdev&#30340;&#25903;&#25345;?
    </p>
  </body>
</html></richcontent>
<node CREATED="1456376659160" ID="ID_1412595718" MODIFIED="1456376871967">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1.&#27599;&#20010;I2C&#35774;&#22791;&#37117;&#26377;&#19968;&#20010;state&#32467;&#26500;&#20307;&#65292;&#25105;&#20204;&#38656;&#35201;&#23558;
    </p>
    <p>
      v4l2_subdev&#23884;&#20837;&#21040;&#35813;state&#32467;&#26500;&#20307;&#24403;&#20013;&#21435;&#65292;&#22914;&#26524;
    </p>
    <p>
      i2c&#39537;&#21160;&#22826;&#31616;&#21333;&#32780;&#27809;&#26377;state&#32467;&#26500;&#20307;&#65292;&#25105;&#20204;&#20063;&#21487;&#20197;&#21333;&#32431;&#22320;&#30452;&#25509;
    </p>
    <p>
      &#21019;&#24314;&#19968;&#20010;v4l2_subdev&#32467;&#26500;&#20307;
    </p>
    <p>
      <b>struct chipname_state { </b>
    </p>
    <p>
      <b>struct v4l2_subdev sd; </b>
    </p>
    <p>
      <b>...&#160;&#160;/* additional state fields */ </b>
    </p>
    <p>
      <b>};</b>
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456376891136" ID="ID_1402498115" MODIFIED="1456377231067">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2.v4l2_i2c_subdev_init(&amp;state-&gt;sd, client, subdev_ops)
    </p>
    <p>
      &#21021;&#22987;&#21270;v4l2_subdev,&#24182;&#19988;&#20445;&#35777;v4l2_subdev&#21644;i2c_client
    </p>
    <p>
      &#20114;&#30456;&#25351;&#21521;&#23545;&#26041;&#65294;
    </p>
    <p>
      struct i2c_client *client = v4l2_get_subdevdata(sd)
    </p>
    <p>
      &#36890;&#36807;v4l2_subdev&#24471;&#21040;i2c_client
    </p>
    <p>
      struct v4l2_subdev *sd = i2c_get_clientdata(client)
    </p>
    <p>
      &#36890;&#36807;i2c_client&#24471;&#21040;v4l2_subdev
    </p>
  </body>
</html></richcontent>
<linktarget COLOR="#341e88" DESTINATION="ID_1402498115" ENDARROW="Default" ENDINCLINATION="222;0;" ID="Arrow_ID_341926369" SOURCE="ID_1162822204" STARTARROW="None" STARTINCLINATION="298;-52;"/>
<node CREATED="1456378269303" ID="ID_1582695542" MODIFIED="1456379050952">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#21033;&#29992;&#26725;&#39537;&#21160;&#30340;&#24110;&#21161;&#20989;&#25968;:
    </p>
    <p>
      struct v4l2_subdev *sd = v4l2_i2c_new_subdev(v4l2_dev, adapter,
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;module_foo&quot;, &quot;chipid&quot;, 0x36, NULL);
    </p>
    <p>
      &#35813;&#20989;&#25968;&#20250;&#21152;&#36733;&#32473;&#23450;&#30340;&#27169;&#22359;&#65292;&#24182;&#19988;&#35843;&#29992;&#36319;adapter&#30456;&#20851;&#30340;
    </p>
    <p>
      i2c_new_device()&#20989;&#25968;&#65292;&#28982;&#21518;&#23427;&#20250;&#21521;v4l2_device&#27880;&#20876;
    </p>
    <p>
      v4l2_subdev
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456379056771" ID="ID_1472571928" MODIFIED="1456380480895">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      struct v4l2_subdev *sd = v4l2_i2c_new_subdev_cfg(v4l2_dev, adapter,
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;module_foo&quot;, &quot;chipid&quot;, 0, NULL, 0, I2C_ADDRS(0x10));
    </p>
    <p>
      &#35813;&#20989;&#25968;&#20250;&#28155;&#21152;irq&#21644;platform_data
    </p>
    <p>
      &#20854;&#20182;&#20004;&#20010;&#21442;&#25968;&#26159;'addr' &#21644;'probed_addrs'&#65292;&#22914;&#26524;'addr'&#19981;&#20026;0&#65292;&#37027;&#20040;&#23601;&#20250;&#20351;&#29992;
    </p>
    <p>
      addr,&#21542;&#21017;&#20351;&#29992;probed_addrs&#26469;&#36827;&#34892;&#21152;&#36733;
    </p>
    <p>
      
    </p>
    <p>
      v4l2_i2c_new_subdev_board&#20989;&#25968;&#20351;&#29992;i2c_board_info struct&#23558;irq,platform_data,
    </p>
    <p>
      addr&#21644;probed_addrs&#23553;&#35013;&#36827;&#21435;&#20102;&#65294;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1456222865879" ID="ID_1512787561" MODIFIED="1527605857879" POSITION="left" TEXT="&#x6587;&#x4ef6;&#x53e5;&#x67c4;">
<font BOLD="true" NAME="SansSerif" SIZE="12"/>
<node CREATED="1456223190786" ID="ID_988059920" MODIFIED="1456391010449">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#25968;&#25454;&#32467;&#26500;&#65306;v4l2_fh
    </p>
    <p>
      &#25552;&#20379;&#20102;&#19968;&#31181;&#20445;&#23384;&#25991;&#20214;&#21477;&#26564;&#25968;&#25454;&#30340;&#26041;&#27861;&#65292;&#26032;&#30340;&#39537;&#21160;
    </p>
    <p>
      &#24517;&#39035;&#20351;&#29992;v4l2_fh,&#22240;&#20026;&#23427;&#25552;&#20379;&#20102;&#20248;&#20808;&#32423;&#30340;&#22788;&#29702;
    </p>
  </body>
</html></richcontent>
<font BOLD="true" NAME="SansSerif" SIZE="12"/>
<node CREATED="1456391080785" ID="ID_341495497" MODIFIED="1456392560889">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      v4l2_fh&#30340;&#21021;&#22987;&#21270;:
    </p>
    <p>
      &#35843;&#29992;v4l2_fh_init()&#20989;&#25968;&#20043;&#21518;&#65292;video_device-&gt;flags&#20013;&#30340;
    </p>
    <p>
      V4L2_FL_USES_V4L2_FH&#20301;&#20250;&#34987;&#32622;&#20301;,&#39537;&#21160;&#36890;&#36807;&#27979;&#35797;&#35813;
    </p>
    <p>
      bit&#65292;&#23601;&#21487;&#20197;&#30693;&#36947;file-&gt;private_data&#26159;&#21542;&#25351;&#21521;&#20102;v4l2_fh&#20102;
    </p>
    <p>
      &#22312;&#35774;&#22791;&#30340;open&#20989;&#25968;&#24403;&#20013;&#35774;&#32622;file-&gt;private_data&#25351;&#21521;v4l2_fh
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456392688731" ID="ID_180722847" MODIFIED="1456393295423">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      v4l2_fh&#30456;&#20851;&#20989;&#25968;&#31616;&#30701;&#31616;&#20171;:
    </p>
    <p>
      1.void v4l2_fh_init(struct v4l2_fh *fh, struct video_device *vdev)
    </p>
    <p>
      &#22312;open&#20989;&#25968;&#37324;&#38754;&#24517;&#39035;&#34987;&#35843;&#29992;&#21040;
    </p>
    <p>
      2.void v4l2_fh_add(struct v4l2_fh *fh)&#23558;v4l2_fh&#28155;&#21152;&#21040;video_device
    </p>
    <p>
      &#30340;&#38142;&#34920;&#24403;&#20013;&#21435;
    </p>
    <p>
      3. void v4l2_fh_del(struct v4l2_fh *fh)
    </p>
    <p>
      4.void v4l2_fh_exit(struct v4l2_fh *fh)
    </p>
    <p>
      &#22914;&#26524;v4l2_fh&#27809;&#26377;&#34987;&#23884;&#20837;&#21040;&#21035;&#30340;&#32467;&#26500;&#20307;&#24403;&#20013;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;&#19979;&#38754;&#30340;&#24110;&#21161;&#20989;&#25968;
    </p>
    <p>
      int v4l2_fh_open(struct file *filp)&#20998;&#37197;&#65292;&#21021;&#22987;&#21270;&#21644;&#28155;&#21152;v4l2_fh&#21040;filp&#24403;&#20013;
    </p>
    <p>
      int v4l2_fh_release(struct file *filp)&#20174;video_device&#38142;&#34920;&#20013;&#35299;&#38500;&#65292;&#24182;&#37322;&#25918;
    </p>
    <p>
      
    </p>
    <p>
      &#22312;&#19968;&#20123;&#39537;&#21160;&#24403;&#20013;&#65292;&#24403;&#21477;&#26564;&#34987;&#31532;&#19968;&#27425;&#25171;&#24320;&#25110;&#32773;&#26368;&#21518;&#19968;&#20010;&#21477;&#26564;&#34987;&#37322;&#25918;&#30340;&#26102;&#20505;&#65292;
    </p>
    <p>
      &#39537;&#21160;&#20250;&#20570;&#19968;&#20123;&#39069;&#22806;&#30340;&#22788;&#29702;&#24037;&#20316;
    </p>
    <p>
      int v4l2_fh_is_singular(struct v4l2_fh *fh)
    </p>
    <p>
      &#36820;&#22238;&#65297;&#22914;&#26524;v4l2_fh&#26159;&#36319;video_device&#30456;&#20851;&#30340;&#21807;&#19968;&#30340;&#25171;&#24320;&#30340;&#25991;&#20214;&#21477;&#26564;
    </p>
    <p>
      int v4l2_fh_is_singular_file(struct file *filp)
    </p>
    <p>
      &#21407;&#29702;&#26159;&#19968;&#26679;&#30340;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1456222964383" ID="ID_52040675" MODIFIED="1456222989047" POSITION="right" TEXT="&#x89c6;&#x9891;&#x7f13;&#x51b2;&#x6846;&#x67b6;">
<font BOLD="true" NAME="SansSerif" SIZE="12"/>
</node>
<node CREATED="1456393574909" ID="ID_1341033271" MODIFIED="1527605862362" POSITION="left">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b>&#20107;&#20214;event </b>
    </p>
    <p>
      v4l2&#25552;&#20379;&#20102;&#19968;&#31181;&#36890;&#30693;&#29992;&#25143;&#31354;&#38388;&#20107;&#20214;&#30340;&#26041;&#27861;&#65292;
    </p>
    <p>
      &#21069;&#25552;&#26159;<font color="#f40707">&#39537;&#21160;&#24517;&#39035;&#20351;&#29992;v4l2_fh</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1456393708788" ID="ID_1211358090" MODIFIED="1456393766950">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#20107;&#20214;&#30340;&#23450;&#20041;:
    </p>
    <p>
      &#20107;&#20214;&#30001;type&#21644;id&#32452;&#25104;&#65292;
    </p>
    <p>
      id&#26631;&#35782;v4l2&#23545;&#35937;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456393840388" ID="ID_317782506" MODIFIED="1456395534277">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#24403;&#29992;&#25143;&#35746;&#38405;&#20102;&#20107;&#20214;&#20043;&#21518;&#65292;&#39537;&#21160;&#20250;&#20998;&#37197;&#19968;&#23450;&#25968;&#37327;&#30340;
    </p>
    <p>
      &#20195;&#34920;&#20107;&#20214;&#30340;kevent structs&#32467;&#26500;&#20307;&#65292;&#36825;&#26679;&#24403;v4l2
    </p>
    <p>
      &#22312;&#30701;&#26102;&#38388;&#20043;&#20869;&#20135;&#29983;&#22823;&#37327;&#30340;&#21516;&#31867;&#22411;&#20107;&#20214;&#30340;&#26102;&#20505;&#19981;&#33267;&#20110;&#35206;&#30422;
    </p>
    <p>
      &#21035;&#30340;&#31867;&#22411;&#30340;&#20107;&#20214;
    </p>
    <p>
      &#26694;&#26550;&#20869;&#37096;&#30340;struct v4l2_subscribed_event&#32467;&#26500;&#20307;&#25317;&#26377;
    </p>
    <p>
      merge()&#21644;replace()&#22238;&#35843;&#20989;&#25968;&#65292;&#24403;&#20107;&#20214;&#20135;&#29983;&#32780;&#21448;&#27809;&#26377;&#26356;&#22810;&#30340;
    </p>
    <p>
      &#31354;&#38388;&#23384;&#20648;&#30340;&#26102;&#20505;&#23601;&#20250;&#35843;&#29992;&#35813;&#22238;&#35843;&#20989;&#25968;&#65294;
    </p>
    <p>
      &#36825;&#20123;&#22238;&#35843;&#20989;&#25968;&#21487;&#20197;&#22312;&#20013;&#26029;&#20989;&#25968;&#37324;&#38754;&#34987;&#35843;&#29992;&#21040;&#65292;&#25152;&#20197;&#20989;&#25968;&#24517;&#39035;&#36275;&#22815;&#24555;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1456395561409" ID="ID_783057501" MODIFIED="1456396072112">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#19968;&#20123;&#26377;&#29992;&#30340;&#20989;&#25968;&#65306;
    </p>
    <p>
      1.void v4l2_event_queue(struct video_device *vdev, const struct v4l2_event *ev)
    </p>
    <p>
      &#23558;&#20107;&#20214;&#25490;&#38431;&#36827;&#20837;video_device&#24403;&#20013;
    </p>
    <p>
      2.int v4l2_event_subscribe(struct v4l2_fh *fh,
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;struct v4l2_event_subscription *sub, unsigned elems,
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;const struct v4l2_subscribed_event_ops *ops)
    </p>
    <p>
      &#24403;&#39537;&#21160;&#30830;&#35748;&#20854;&#26377;&#33021;&#21147;&#20135;&#29983;&#30456;&#24212;id&#30340;&#20107;&#20214;&#26102;&#65292;&#35843;&#29992;&#35813;&#20989;&#25968;&#27880;&#20876;&#20107;&#20214;
    </p>
    <p>
      elems&#25351;&#23450;&#35813;&#20107;&#20214;&#23545;&#24212;&#30340;&#20107;&#20214;&#38431;&#21015;&#30340;&#38271;&#24230;
    </p>
    <p>
      ops&#29992;&#20110;&#25351;&#23450;&#22238;&#35843;&#20989;&#25968;
    </p>
    <p>
      3.int v4l2_event_unsubscribe(struct v4l2_fh *fh,
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;struct v4l2_event_subscription *sub)
    </p>
    <p>
      4.int v4l2_event_pending(struct v4l2_fh *fh)&#36820;&#22238;&#25346;&#36215;&#30340;&#20107;&#20214;&#30340;&#20010;&#25968;
    </p>
    <p>
      
    </p>
    <p>
      <b>&#20107;&#20214;&#36890;&#36807;poll&#31995;&#32479;&#35843;&#29992;&#36882;&#36865;&#21040;&#29992;&#25143;&#31354;&#38388;&#65292;&#39537;&#21160;&#31243;&#24207;&#24403;&#20013;&#21487;&#20197;&#20351;&#29992; </b>
    </p>
    <p>
      <b>v4l2_fh-&gt;wait (a wait_queue_head_t)&#20316;&#20026;poll_wait&#30340;&#21442;&#25968;</b>
    </p>
    <p>
      <br />
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1508501631356" ID="ID_172284524" MODIFIED="1508502271811" POSITION="left">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font size="4" color="#0d630f"><b>V4L2&#25991;&#26723;&#23398;&#20064;</b></font>
    </p>
    <p>
      <font color="#a00505">&#32593;&#22336;: https://linuxtv.org/downloads/v4l-dvb-apis/uapi/v4l/v4l2.html</font>
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1527651211698" ID="ID_1835299552" MODIFIED="1527651220971" POSITION="left" TEXT="media framework">
<font BOLD="true" NAME="SansSerif" SIZE="12"/>
<node CREATED="1527651317873" ID="ID_911304303" MODIFIED="1527652174098">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#21457;&#29616;&#35774;&#22791;&#30340;&#20869;&#37096;&#25299;&#25169;&#32467;&#26500;&#24182;&#19988;&#22312;&#36816;&#34892;&#26102;&#21051;&#37197;&#32622;&#23427;&#65292;&#36825;&#26159;media framewrok&#30340;&#19968;&#20010;&#30446;&#26631;&#20043;&#19968;&#12290;
    </p>
    <p>
      &#20026;&#20102;&#23454;&#29616;&#36825;&#20010;&#30446;&#26631;&#65292;&#30828;&#20214;&#35774;&#22791;&#34987;&#24314;&#27169;&#25104;&#20102;&#19968;&#20010;&#26377;&#21521;&#22270;&#65292;&#25104;&#20026;entities,&#36890;&#36807;pads&#26469;&#36827;&#34892;&#36830;&#25509;&#12290;
    </p>
    <p>
      &#19968;&#20010;entity&#23601;&#26159;&#19968;&#20010;&#22522;&#26412;&#30340;&#23186;&#20307;&#30828;&#20214;&#26500;&#24314;&#22359;&#65292;&#23427;&#21487;&#20197;&#23545;&#24212;&#21040;&#22810;&#31181;&#22810;&#26679;&#30340;&#36923;&#36753;&#22359;&#19978;&#65292;&#27604;&#22914;&#29289;&#29702;&#30340;&#30828;&#20214;&#35774;&#22791;&#65292;
    </p>
    <p>
      &#36923;&#36753;&#30828;&#20214;&#35774;&#22791;(&#27604;&#22914;&#19968;&#20010;&#29255;&#19978;&#30340;&#22270;&#20687;&#22788;&#29702;pipeline), DMA&#36890;&#36947;&#25110;&#32773;&#19968;&#20010;&#29289;&#29702;&#30340;&#36830;&#25509;&#12290;
    </p>
    <p>
      
    </p>
    <p>
      &#19968;&#20010;pad&#23601;&#26159;&#19968;&#20010;&#36830;&#25509;&#30340;&#31471;&#28857;&#65292;&#36890;&#36807;&#35813;&#31471;&#28857;&#65292;&#19968;&#20010;entity&#21487;&#20197;&#36319;&#20854;&#20182;&#30340;entity&#36827;&#34892;&#20132;&#27969;&#12290;
    </p>
    <p>
      &#19968;&#20010;link&#23601;&#26159;&#22312;&#20004;&#20010;pad&#20043;&#38388;&#30340;&#36830;&#25509;&#65292;&#25968;&#25454;&#20174;source pad&#27969;&#21521;sink pad
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1502794414287" ID="ID_491536815" MODIFIED="1502794425919" POSITION="right" TEXT="MIPI&#x534f;&#x8bae;&#x5b66;&#x4e60;">
<font BOLD="true" NAME="SansSerif" SIZE="12"/>
<node CREATED="1502794468790" ID="ID_1882812769" MODIFIED="1535934973462">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#25991;&#26723;
    </p>
    <p>
      MIPI Alliance Specification for Camera Serial Interface 2
    </p>
    <p>
      Version 1.01.00 Revision 0.04
    </p>
  </body>
</html></richcontent>
<node CREATED="1502794717510" ID="ID_1865830493" MODIFIED="1502794728270" TEXT="overview">
<font BOLD="true" NAME="SansSerif" SIZE="12"/>
<node CREATED="1502794734814" ID="ID_375875861" MODIFIED="1502796155852">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      CSI-2&#21327;&#35758;&#23450;&#20041;&#20102;&#22312;&#20256;&#36755;&#31471;&#21644;&#25509;&#25910;&#31471;&#20043;&#38388;&#30340;&#26631;&#20934;&#30340;&#25968;&#25454;&#21644;&#25511;&#21046;&#25509;&#21475;&#12290;
    </p>
    <p>
      &#25968;&#25454;&#20256;&#36755;&#25509;&#21475;&#26159;&#21333;&#21521;(unidirectional)&#24046;&#20998;&#20018;&#34892;&#25509;&#21475;&#65292;&#20851;&#20110;&#35813;&#25509;&#21475;&#30340;&#29289;&#29702;&#23618;&#30340;&#25551;&#36848;&#65292;&#21487;&#20197;&#21442;&#32771;&#25991;&#26723;
    </p>
    <p>
      MIPI Alliance Specification for D-PHY
    </p>
  </body>
</html></richcontent>
<node CREATED="1502847766778" ID="ID_1413392146" MODIFIED="1502847775777">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="mipi/CSI-2-transmission.png" />
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1502847975910" ID="ID_731155694" MODIFIED="1502848003079">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b>CSI-2&#30340;&#23618;&#27425;&#24615;&#32467;&#26500;</b>
    </p>
  </body>
</html></richcontent>
<node CREATED="1502848084358" ID="ID_1139121378" MODIFIED="1502848089695" TEXT="&#x7269;&#x7406;&#x5c42;"/>
<node CREATED="1502848093278" ID="ID_197853091" MODIFIED="1502862234479">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#21327;&#35758;&#23618;
    </p>
    <p>
      &#21327;&#35758;&#23618;&#30001;&#20960;&#20010;&#19981;&#21516;&#30340;&#23618;&#27425;&#32452;&#25104;&#65292;&#27599;&#19968;&#23618;&#37117;&#20855;&#26377;&#29420;&#29305;&#30340;&#21151;&#33021;&#12290;
    </p>
    <p>
      CSI-2&#21327;&#35758;&#20801;&#35768;&#22810;&#20010;&#25968;&#25454;&#27969;&#20351;&#29992;host&#19978;&#38754;&#30340;&#21516;&#19968;&#20010;&#25509;&#21475;&#12290;&#21327;&#35758;&#23618;&#29992;&#26469;&#25351;&#23450;
    </p>
    <p>
      &#22810;&#20010;&#25968;&#25454;&#27969;&#22914;&#20309;&#28155;&#21152;tag&#21644;&#25554;&#20837;&#65292;&#36825;&#26679;&#21487;&#20197;&#26041;&#20415;&#22320;&#23558;&#25968;&#25454;&#27969;&#36827;&#34892;&#37325;&#26500;&#12290;
    </p>
    <p>
      
    </p>
    <p>
      &#21327;&#35758;&#23618;&#30340;&#25968;&#25454;&#37117;&#34987;&#32452;&#32455;&#25104;packet&#30340;&#24418;&#24335;&#65292;&#22312;low level protocol&#23618;&#65292;
    </p>
    <p>
      &#20250;&#23558;&#22836;&#37096;&#21644;&#21487;&#36873;&#30340;&#38169;&#35823;&#26816;&#27979;&#20449;&#24687;&#28155;&#21152;&#21040;&#25968;&#25454;&#37324;&#38754;
    </p>
  </body>
</html></richcontent>
<node CREATED="1502848903621" ID="ID_386224003" MODIFIED="1502859730319">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Pixel/Byte Packing/Unpacking Layer
    </p>
    <p>
      CSI-2&#25903;&#25345;&#21508;&#31181;pixel&#30340;&#26684;&#24335;&#65292;&#21253;&#25324;&#20174;6bit&#21040;24bit&#30340;&#20687;&#32032;&#26684;&#24335;&#12290;
    </p>
    <p>
      &#22312;&#20256;&#36755;&#36807;&#31243;&#24403;&#20013;&#65292;&#35813;&#23618;&#23558;&#24212;&#29992;&#23618;&#30340;pixel&#25171;&#21253;&#25104;byte&#26684;&#24335;&#20256;&#36882;&#32473;&#19979;&#19968;&#23618;&#65292;
    </p>
    <p>
      &#22312;&#25509;&#25910;&#36807;&#31243;&#24403;&#20013;&#65292;&#35813;&#23618;&#23558;&#19979;&#23618;&#20256;&#36882;&#36807;&#26469;&#30340;byte&#21464;&#25104;pixel&#26684;&#24335;&#20256;&#36882;&#32473;&#24212;&#29992;&#23618;&#65292;
    </p>
    <p>
      &#23545;&#20110;8 bit&#30340;pixel, &#35813;&#23618;&#20250;&#30452;&#25509;&#23558;&#25968;&#25454;&#20256;&#36882;&#32473;&#19979;&#23618;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1502859736549" ID="ID_891207066" MODIFIED="1502861558977">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Low Level Protocol
    </p>
    <p>
      LLP&#23618;&#21253;&#21547;&#22312;SoT&#21644;EoT&#20107;&#20214;&#20043;&#38388;&#30340;&#20018;&#34892;&#25968;&#25454;&#20256;&#36755;&#30340;&#36807;&#31243;&#24403;&#20013;&#30340;
    </p>
    <p>
      bit&#23618;&#38754;&#21644;byte&#23618;&#38754;&#30340;&#21516;&#27493;&#26041;&#27861;&#12290;&#20197;&#21450;&#23558;&#25968;&#25454;&#20256;&#36755;&#32473;&#19979;&#19968;&#23618;&#30340;&#26041;&#27861;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1502861714822" ID="ID_296618621" MODIFIED="1502861858008">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Lane Management
    </p>
    <p>
      csi-2&#30340;lane&#30340;&#25968;&#37327;&#26159;&#21487;&#20197;&#25193;&#23637;&#30340;&#65292;&#26681;&#25454;&#24212;&#29992;&#23618;&#38656;&#35201;&#30340;&#24102;&#23485;&#25968;&#37327;&#65292;&#26368;&#22810;&#21487;&#20197;
    </p>
    <p>
      &#25193;&#23637;&#21040;4&#20010;lane&#30340;&#25968;&#37327;&#12290;&#22312;&#21457;&#36865;&#31471;&#23558;stream data&#20998;&#21457;&#21040;&#19968;&#20010;&#25110;&#32773;&#22810;&#20010;lane
    </p>
    <p>
      &#37324;&#38754;&#65292;&#22312;&#25509;&#25910;&#31471;&#23558;lane&#30340;&#25968;&#25454;&#37325;&#26032;&#32452;&#21512;&#25104;stream data&#12290;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1502862239716" ID="ID_1038781538" MODIFIED="1502862267733">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#24212;&#29992;&#23618;
    </p>
    <p>
      &#35813;&#23618;&#21253;&#21547;&#20102;&#23545;&#26356;&#39640;&#23618;&#27425;&#30340;&#25968;&#25454;&#30340;&#32534;&#30721;&#21644;&#33258;&#25105;&#35299;&#37322;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1502865167422" ID="ID_1097360782" MODIFIED="1502865174626">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="mipi/CSI-2-layer-structure.png" />
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1502862827209" ID="ID_1049657213" MODIFIED="1502864703759">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b>&#31532;&#20845;&#31456; Camera Control Interface(CCI)</b>
    </p>
  </body>
</html></richcontent>
<node CREATED="1543487037584" ID="ID_1342658554" MODIFIED="1543487264211">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      A CSI-2 receiver shall be configured as a master and a CSI-2 transmitter shall be configured as a slave on
    </p>
    <p>
      the CCI bus.
    </p>
    <p>
      &#23545;&#24212;&#20110;csi&#30340;&#25509;&#21475;&#65292;&#25509;&#25910;&#31471;&#24212;&#35813;&#34987;&#37197;&#32622;&#25104;cci&#30340;master, &#32780;csi&#30340;&#21457;&#36865;&#31471;&#21017;&#24212;&#35813;&#34987;&#35774;&#32622;&#25104;&#20026;cci&#30340;slave&#31471;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1545117510938" ID="ID_149198694" MODIFIED="1545117570357">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="i2c/i2c&#x4f20;&#x8f93;.PNG" />
  </body>
</html>
</richcontent>
</node>
</node>
<node CREATED="1502864670166" ID="ID_525114129" MODIFIED="1502864692888">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b>&#31532;&#20843;&#31456; Multi-Lane Distribution and Merging</b>
    </p>
  </body>
</html></richcontent>
<node CREATED="1502865700236" ID="ID_184629333" MODIFIED="1502866811900">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      lane&#20998;&#21457;&#22120;&#21487;&#20197;&#25509;&#25910;&#20219;&#24847;&#38271;&#24230;&#30340;&#20256;&#36755;&#25968;&#25454;&#65292;&#32531;&#23384;N&#20010;&#23383;&#33410;&#30340;&#25968;&#25454;&#65292;
    </p>
    <p>
      &#28982;&#21518;&#22312;N&#20010;&#36890;&#36947;&#19978;&#38754;&#24182;&#34892;&#22320;&#21457;&#36865;N&#32452;&#25968;&#25454;&#12290;&#22312;&#21457;&#36865;&#25968;&#25454;&#20043;&#21069;&#65292;&#25152;&#26377;lane
    </p>
    <p>
      &#38656;&#35201;&#21457;&#36865;SoT&#20449;&#21495;&#32473;&#25509;&#25910;&#31471;&#26469;&#34920;&#26126;&#19968;&#20010;&#25968;&#25454;&#21253;&#30340;&#31532;&#19968;&#20010;&#23383;&#33410;&#35201;&#24320;&#22987;&#21457;&#36865;&#20102;&#12290;
    </p>
    <p>
      &#22312;&#21457;&#36865;&#30340;&#26411;&#23614;&#21487;&#33021;&#26377;&#22810;&#20313;&#30340;&#23383;&#33410;&#23384;&#22312;&#65292;&#22240;&#20026;&#21457;&#36865;&#30340;&#23383;&#33410;&#25968;&#21487;&#33021;&#19981;&#26159;lane
    </p>
    <p>
      &#25968;&#30446;&#30340;&#25972;&#25968;&#20493;&#12290;&#22312;&#21457;&#36865;&#25968;&#25454;&#32467;&#26463;&#30340;&#26411;&#23614;&#38454;&#27573;&#65292;&#30001;&#20110;lane&#20998;&#21457;&#22120;&#20250;&#24182;&#34892;&#22320;
    </p>
    <p>
      &#32531;&#23384;&#19981;&#36275;N&#20010;&#23383;&#33410;&#26469;&#20998;&#21457;&#32473;N&#20010;&#36890;&#36947;&#65292;&#23427;&#20250;&#23558;&#25152;&#26377;&#30340;&#36890;&#36947;&#30340;&#26377;&#25928;&#20449;&#24687;&#32473;&#21435;&#38500;&#65292;
    </p>
    <p>
      &#20197;&#27492;&#26469;&#36890;&#30693;&#21508;&#20010;&#36890;&#36947;&#25968;&#25454;&#21457;&#36865;&#35201;&#32467;&#26463;&#20102;&#12290;
    </p>
  </body>
</html></richcontent>
<node CREATED="1502866830089" ID="ID_1475742854" MODIFIED="1502867299035">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#34429;&#28982;&#22810;&#20010;&#36890;&#36947;&#20250;&#21516;&#27493;&#22320;&#20197;SoT&#20107;&#20214;&#26469;&#24320;&#22987;&#36827;&#34892;&#20256;&#36755;&#65292;&#20294;&#26159;&#27599;&#20010;
    </p>
    <p>
      &#36890;&#36947;&#26377;&#21487;&#33021;&#20250;&#22312;&#19981;&#21516;&#30340;&#26102;&#38388;&#20869;&#23436;&#25104;&#20256;&#36755;&#65292;&#22312;&#19968;&#36718;&#21608;&#26399;&#24403;&#20013;&#20998;&#24320;&#21457;&#36865;
    </p>
    <p>
      EoT&#20449;&#21495;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1502867303833" ID="ID_1757575879" MODIFIED="1502867330114">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#c91111">&#22810;&#20010;lane&#20043;&#38388;&#30340;&#20114;&#32852;&#20114;&#36890;</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1502868435942" ID="ID_1871985624" MODIFIED="1502868704424">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#19968;&#20010;&#20855;&#26377;N&#20010;lane&#30340;receiver&#21487;&#20197;&#36319;&#20855;&#26377;M&#20010;lane&#30340;transmitter&#30456;&#20114;&#36830;&#25509;&#65292;
    </p>
    <p>
      &#24403;&#25105;&#20204;&#20351;&#29992;&#36229;&#36807;&#19968;&#20010;&#25968;&#25454;lane&#30340;&#26102;&#20505;&#65292;&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;cci&#26469;&#37197;&#32622;CSI-2&#25509;&#25910;&#22120;
    </p>
    <p>
      &#21644;&#21457;&#36865;&#22120;&#37324;&#38754;&#30340;Lane distribution and merging&#23618;&#23436;&#25104;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1502868718102" ID="ID_1909591836" MODIFIED="1504766856844">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b>&#31532;&#20061;&#31456; Low Level Protocol </b>
    </p>
    <p>
      llp&#26159;&#38754;&#21521;&#23383;&#33410;&#30340;&#65292;&#22522;&#20110;&#25968;&#25454;&#21253;&#30340;&#20256;&#36755;&#21327;&#35758;, &#25903;&#25345;&#20351;&#29992;Short&#21644;Long&#21253;&#26684;&#24335;
    </p>
    <p>
      &#26469;&#20256;&#36755;&#20219;&#24847;&#38271;&#24230;&#30340;&#25968;&#25454;&#21253;&#12290;
    </p>
    <p>
      Low Level Protocol&#30340;&#29305;&#28857;:
    </p>
    <p>
      1.&#23545;&#20110;&#20219;&#24847;&#30340;&#25968;&#25454;&#38271;&#24230;&#30340;&#20256;&#36755;
    </p>
    <p>
      2.8-bit&#30340;&#25968;&#25454;&#23485;&#24230;
    </p>
    <p>
      3.&#25903;&#25345;&#21516;&#19968;&#20010;&#38142;&#36335;&#19978;&#38754;&#26368;&#22810;&#22235;&#20010;&#20132;&#38169;&#30340;&#34394;&#25311;&#36890;&#36947;
    </p>
    <p>
      4.&#23545;&#20110;frame start, frame stop, line start&#21644;line stop&#37117;&#26377;&#29305;&#27530;&#30340;&#25968;&#25454;&#21253;&#23545;&#24212;
    </p>
    <p>
      5.&#23545;&#20110;&#24212;&#29992;&#31243;&#24207;&#25351;&#23450;&#30340;&#25968;&#25454;&#36127;&#36733;&#30340;type, pixel depth &#21644; format&#37117;&#26377;&#23545;&#24212;&#30340;&#25551;&#36848;&#31526;&#25551;&#36848;
    </p>
    <p>
      6.16-bit&#30340;&#26657;&#39564;&#30721;
    </p>
  </body>
</html></richcontent>
<node CREATED="1510217346674" ID="ID_407029654" MODIFIED="1535935696711">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <ol>
      <li>
        packet&#30340;&#26684;&#24335;
      </li>
    </ol>
    <p>
      &#23450;&#20041;&#20102;&#20004;&#31181;&#21253;&#30340;&#26684;&#24335;&#65292;short packet&#21644;long packet
    </p>
    <p>
      &#23545;&#20110;&#27599;&#19968;&#20010;&#20174;low power state&#29366;&#24577;&#36864;&#20986;&#30340;&#25968;&#25454;&#21253;&#20250;&#36319;&#30528;&#19968;&#20010;SoT
    </p>
    <p>
      &#24207;&#21015;&#29992;&#26469;&#34920;&#26126;&#19968;&#20010;&#25968;&#25454;&#21253;&#30340;&#24320;&#22987;&#21457;&#36865;&#65292;&#23545;&#20110;&#25968;&#25454;&#21253;&#30340;&#32467;&#26463;&#20250;&#36319;&#38543;&#30528;
    </p>
    <p>
      &#19968;&#20010;EoT&#24207;&#21015;&#65292;&#21516;&#26102;&#35813;&#25968;&#25454;&#21253;&#36827;&#20837;&#20102;low power state&#29366;&#24577;&#12290;
    </p>
  </body>
</html></richcontent>
<node CREATED="1510217886926" ID="ID_746972144" MODIFIED="1510218312678">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Long Packet&#30340;&#25968;&#25454;&#26684;&#24335;
    </p>
    <p>
      &#27599;&#20010;&#23383;&#33410;&#26159;&#25353;&#29031;least significant&#30340;&#26684;&#24335;&#36827;&#34892;&#20256;&#36755;&#30340;&#65292;payload&#37096;&#20998;&#30340;
    </p>
    <p>
      &#23383;&#33410;&#20256;&#36755;&#30340;&#24207;&#21015;&#21482;&#25910;&#21040;&#35813;&#37096;&#20998;&#30340;&#25968;&#25454;&#26684;&#24335;&#30340;&#24433;&#21709;&#12290;
    </p>
  </body>
</html></richcontent>
<node CREATED="1510218194157" ID="ID_387054374" MODIFIED="1510218199659">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="mipi/mipi-llp-LongPacketFormat01.png" />
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1510218335036" ID="ID_206463631" MODIFIED="1510218568764">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Short Packet&#30340;&#26684;&#24335;
    </p>
  </body>
</html></richcontent>
<node CREATED="1510218572202" ID="ID_1235951739" MODIFIED="1510218639396">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <img src="mipi/mipi-llp-ShortPacketFormat.png" />
      
    </p>
    <p>
      &#25105;&#20204;&#21487;&#20197;&#30475;&#21040;short packet&#30340;&#26684;&#24335;&#20854;&#23454;&#23601;&#26159;long packet&#30340;&#22836;&#37096;&#20998;&#65292;
    </p>
    <p>
      &#21482;&#19981;&#36807;&#23558;WC&#37096;&#20998;&#26367;&#25442;&#25104;&#20102;&#30701;&#25968;&#25454;&#21253;&#30340;&#25968;&#25454;&#36127;&#36733;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1510224114903" ID="ID_1960772794" MODIFIED="1510224355689">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2. Data Identifier
    </p>
    <p>
      &#19968;&#20010;&#23383;&#33410;&#65292;&#21253;&#21547;&#34394;&#25311;&#36890;&#36947;id&#21644;data type&#65292; &#34394;&#25311;&#36890;&#36947;id&#26159;&#20004;&#20010;bit,
    </p>
    <p>
      data type&#21017;&#26159;6&#20010;bit
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1535936045604" ID="ID_1885186647" MODIFIED="1535936974331">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3. Virtual Channel Identifier
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1535936085584" ID="ID_1481313714" MODIFIED="1535936982379">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      4. Data Type
    </p>
  </body>
</html></richcontent>
<node CREATED="1535936166547" ID="ID_1714506362" MODIFIED="1535936224330">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      data type&#25351;&#23450;&#36127;&#36733;&#25968;&#25454;&#30340;&#20869;&#23481;&#36319;&#26684;&#24335;&#65292;&#30446;&#21069;&#19968;&#20849;&#26377;64&#31181;
    </p>
    <p>
      &#25968;&#25454;&#26684;&#24335;&#65292;&#20998;&#25104;&#20102;8&#20010;&#31867;&#21035;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1535936886105" ID="ID_886917977" MODIFIED="1535936908165">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <img src="mipi/datatype.JPG" />
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1535936985208" ID="ID_1061680033" MODIFIED="1535937003928" TEXT="5. Packet Header Error Correction Code"/>
<node CREATED="1535937027009" ID="ID_1435522503" MODIFIED="1535937039014" TEXT="6. Checksum Generation"/>
<node CREATED="1535937042338" ID="ID_1120083451" MODIFIED="1535937051803" TEXT="7. Packet Spacing"/>
<node CREATED="1535937069335" ID="ID_1003544556" MODIFIED="1535937105188">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      8. Synchronization Short Packet Data Type Codes
    </p>
  </body>
</html></richcontent>
<node CREATED="1535937108432" ID="ID_1098540905" MODIFIED="1535937135909">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Frame Synchronization Packet
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1535937138393" ID="ID_1220797065" MODIFIED="1535937159730">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Line Synchronization Packets
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1527585443389" FOLDED="true" ID="ID_1269988627" MODIFIED="1535934969802" POSITION="right">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b><font size="4" color="#380fef"><i>8916 camera driver&#26694;&#26550;&#23398;&#20064;</i></font></b>
    </p>
  </body>
</html></richcontent>
<node CREATED="1527585511772" ID="ID_192520650" MODIFIED="1527585520793" TEXT="1. device tree&#x7ed3;&#x6784;">
<node CREATED="1527585962352" ID="ID_1014306860" MODIFIED="1527585965121" TEXT="msm8916-mtp.dts">
<node CREATED="1527585975752" ID="ID_782603776" MODIFIED="1527585978886" TEXT="msm8916-mtp.dtsi">
<node CREATED="1527586016888" ID="ID_170662633" MODIFIED="1527586019921" TEXT="msm8916.dtsi">
<node CREATED="1527586216534" ID="ID_689792673" MODIFIED="1527586220065" TEXT="skeleton64.dtsi"/>
<node CREATED="1527586232110" ID="ID_928328023" MODIFIED="1527586234907" TEXT="dt-bindings/clock/msm-clocks-8916.h"/>
<node CREATED="1527586246815" ID="ID_1081591591" MODIFIED="1527586249494" TEXT="dt-bindings/clock/msm-clocks-a7.h"/>
<node CREATED="1527586263504" ID="ID_1988189146" MODIFIED="1527586266218" TEXT="msm8916-coresight.dtsi"/>
<node CREATED="1527586275483" ID="ID_1544788923" MODIFIED="1527586278030" TEXT="msm8916-smp2p.dtsi"/>
<node CREATED="1527596669142" ID="ID_231067818" MODIFIED="1527596674377" TEXT="msm8916-pinctrl.dtsi"/>
<node CREATED="1527596685358" ID="ID_857847209" MODIFIED="1527596688709" TEXT="msm8916-camera.dtsi"/>
<node CREATED="1527596701181" ID="ID_1495201595" MODIFIED="1527596704668" TEXT="msm8916-ipcrouter.dtsi"/>
<node CREATED="1527596717022" ID="ID_1389744374" MODIFIED="1527596720339" TEXT="msm-gdsc-8916.dtsi"/>
<node CREATED="1527596731773" ID="ID_1219143995" MODIFIED="1527596735417" TEXT="msm8916-iommu.dtsi"/>
<node CREATED="1527596744836" ID="ID_114687933" MODIFIED="1527596748147" TEXT="msm8916-gpu.dtsi"/>
<node CREATED="1527596758468" ID="ID_1538740399" MODIFIED="1527596761364" TEXT="msm8916-mdss.dtsi"/>
<node CREATED="1527596770260" ID="ID_1896690725" MODIFIED="1527596772932" TEXT="msm8916-mdss-pll.dtsi"/>
<node CREATED="1527596783332" ID="ID_1171108274" MODIFIED="1527596786544" TEXT="msm8916-iommu-domains.dtsi"/>
<node CREATED="1527596796308" ID="ID_1963423109" MODIFIED="1527596799698" TEXT="msm8916-bus.dtsi"/>
<node CREATED="1527597185749" ID="ID_329593203" MODIFIED="1527597189109" TEXT="msm-pm8916-rpm-regulator.dtsi"/>
<node CREATED="1527597200597" ID="ID_221126910" MODIFIED="1527597203899" TEXT="msm-pm8916.dtsi"/>
<node CREATED="1527597215468" ID="ID_1632627334" MODIFIED="1527597218443" TEXT="msm8916-regulator.dtsi"/>
<node CREATED="1527597232724" ID="ID_230823237" MODIFIED="1527597235832" TEXT="msm8916-pm.dtsi"/>
</node>
<node CREATED="1527586030672" ID="ID_934668742" MODIFIED="1527586033452" TEXT="msm8916-pinctrl.dtsi"/>
<node CREATED="1527586043136" ID="ID_1221835112" MODIFIED="1527586046000" TEXT="msm8916-camera-sensor-mtp.dtsi"/>
</node>
<node CREATED="1527585988288" ID="ID_920027480" MODIFIED="1527585991421" TEXT="msm8916-memory.dtsi">
<node CREATED="1527586065903" ID="ID_38878983" MODIFIED="1527586068783" TEXT="msm8916-ion.dtsi"/>
</node>
</node>
</node>
<node CREATED="1527607297703" ID="ID_1209502919" MODIFIED="1527607307618" TEXT="2.&#x9a71;&#x52a8;&#x4ee3;&#x7801;&#x5206;&#x6790;">
<node CREATED="1527607348207" ID="ID_495796491" MODIFIED="1527607565031">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#24635;&#20837;&#21475;&#28857;&#65292; &#20195;&#30721;&#20301;&#32622;<b>kernel/drivers/media/platform/msm/camera_v2/msm.c</b>
    </p>
    <p>
      &#35813;&#25991;&#20214;&#30340;&#24179;&#21488;&#39537;&#21160;&#31243;&#24207;&#23545;&#24212;&#30340;&#26159;&#35774;&#22791;
    </p>
    <p>
      qcom,msm-cam@1800000{
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;compatible = &quot;qcom,msm-cam&quot;;
    </p>
    <p>
      &#160;&#160;&#160;&#160;};&#160;
    </p>
    <p>
      &#35774;&#22791;&#26641;&#37324;&#38754;&#21482;&#23450;&#20041;&#20102;&#19968;&#20010;compatible&#23646;&#24615;&#65292;&#20854;&#20182;&#30340;&#27809;&#26377;&#23450;&#20041;&#65292;&#21487;&#30693;&#36825;&#37324;&#30340;&#24179;&#21488;&#35774;&#22791;&#24212;&#35813;
    </p>
    <p>
      &#26159;&#19968;&#20010;&#24635;&#30340;&#20837;&#21475;&#35774;&#22791;&#12290;&#25105;&#20204;&#30475;&#30475;&#35813;&#24179;&#21488;&#39537;&#21160;&#30340;probe&#20989;&#25968;
    </p>
    <p>
      <b>int msm_probe(struct platform_device *pdev)</b>&#160;&#20570;&#20102;&#20160;&#20040;&#25805;&#20316;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
</map>
